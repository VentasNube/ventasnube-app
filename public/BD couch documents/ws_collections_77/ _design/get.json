{
    "_id": "_design/get",
    "_rev": "292-69d15506a577fd8a9f283f6ae77ca345",
    "views": {
      "type": {
        "map": "function(doc) {\nif(doc.status === 'active' && doc.type === 'product' || doc.type === 'service') {\n        emit(doc.type,{\n          \"tipo\": doc.type,\n          \"price\": 150,\n          \"stock\": 1,\n          \"discount\": 0,\n          \"tax\": 150\n        });\n    }\n}"
      },
      "sku": {
        "map": "function(doc) {\nif(doc.status === 'active' && doc.type === 'product' || doc.type === 'service' ) {\n        emit(doc.sku,{\n          \"tipo\": doc.type,\n          \"price\": 150,\n          \"stock\": 1,\n          \"discount\": 0,\n          \"tax\": 150,\n          \"SKU\":doc.variations[0].sku.value_name\n        });\n    }\n} "
      },
      "status": {
        "map": "function(doc) {\nif(doc.status === 'active' ) {\n        emit(doc.status,{\n          \"tipo\": doc.type,\n          \"price\": 150,\n          \"stock\": 1,\n          \"discount\": 0,\n          \"tax\": 150\n        });\n    }\n}"
      },
      "seach": {
        "map": "function(doc) {\n  if(doc.tags.length > 0) {\n    for(var idx in doc.tags) {\n      emit(doc.tags[idx], null);\n    }\n  }\n}\n*/\n\nfunction(doc) {\n   \n      if(doc.status === 'active' || doc.type === 'product'){\n              var attribute_combinations = new Array();\n                for(var i=0, length=doc.variations.length; i<length; i++){\n                    var price_list = doc.variations[0].price_list;\n                    var stock_list =  doc.variations[0].stock_list;\n                    var pictures_min = doc.variations[0].pictures[0].min;\n                    var pictures_max = doc.variations[0].pictures[0].max;\n                    var sku = doc.variations[0].sku.value_name;\n                    var variant_id = doc.variations[0].id;\n                   // var attribute_combinations = doc.variations[i].attribute_combinations;\n                    // attribute_combination.push(doc.variations[i].attribute_combinations);\n                    //  attribute_combinations_array.push(attribute_combination);\n                    //  var attribute_combinations = attribute_combination;\n                    //  var row;\n                    \n                     // while(row = getRow()) {\n                   //  attribute_combinations.push(doc.variations[0].attribute_combinations);\n                     \n                    var attribute_combinations = doc.variations[0].attribute_combinations\n                    //  }\n                 }\n                 \n                 \n                 \n               emit([doc.name],{\n                      \"_id\": doc._id,\n                      \"_rev\":doc._rev,\n                      \"variant_id\":variant_id,\n                      \"tipo\": doc.type,\n                      \"name\": doc.name,\n                      \"tags\": doc.tags,\n                      \"currency\": doc.currency.value,\n                      \"available_quantity\": doc.available_quantity,\n                      \"sold_quantity\": doc.sold_quantity,\n                      \"cost_price\": doc.cost_price,\n                      \"limit_discount\": doc.limit_discount,\n                      \"price\":doc.variations[0].price_list[0].value,\n                      \"price_list\":price_list,\n                      \"stock_list\":stock_list,\n                      \"sku\": sku,\n                      \"picture_min\":pictures_min,\n                      \"picture_max\":pictures_max,\n                      \"attribute_combinations\":attribute_combinations\n                      // \"pictures_all\":pictures_all,\n                      //\"price_list\":doc.variations[0].price_list,\n                      //\"picture_min\":doc.variations[0].pictures.min,\n                      //\"picture_max\":doc.variations[0].pictures.max\n                       //\"category_list\":category_array,\n                       //\"variations\":doc.variations,\n                });\n             // }\n              \n      }\n       \n      /* if( doc.type === 'price_list') {   \n         \n        //   emit(doc.price_list);\n           //  \"type\": \"price_list\",\n           emit(doc.type, [doc.price_list, 0]);\n        }\n   */\n}\n\n"
      },
      "items": {
        "map": "\nfunction(doc) {\n  \n   /* var price_list = 0;\n      if( doc.type === 'price_list') {\n         // emit(price_list =  doc.price_list)\n          var price_list = doc.price_list\n      }\n      */\n      /*   for(var i=0, length=doc.invoices.length; i<length; i++){\n                    emit(\n                        // emit array of invoiceNumber and barCode as key:\n                        [doc.invoices[i].invoiceNumber, doc.invoices[i].barCode],\n                        // emit array of clientId and clientName as value\n                        // Actually, value can be whatever you want:\n                        [doc.clientId, doc.clientName]\n                    );\n                }\n*/\n\n for(var i=0, length=doc.variations.length; i<length; i++){\n                   emit(\n                        // emit array of invoiceNumber and barCode as key:\n                      [doc.name, doc.variations[i].sku.value_name],\n                        {\n                          \n                      \"tipo\": doc.type,\n                      \"name\": doc.name,\n                      \"tags\": doc.tags,\n                      \"available_quantity\": doc.available_quantity,\n                      \"sold_quantity\": doc.sold_quantity,\n                      \"cost_price\": doc.cost_price,\n                      \"limit_discount\": doc.limit_discount,\n                      \"sku\":doc.variations[0].sku.value_name,\n                      \"currency\": doc.currency.value,\n                        }\n                    );\n                }\n\n     /*     for(var i=0, length=doc.variations.length; i<length; i++){\n                   emit(\n                        // emit array of invoiceNumber and barCode as key:\n                        [doc.name, doc.variations[i].sku.value_name],\n                        {\n                      \"name\": doc.name,\n                       \"sku\":doc.variations[i].sku.value_name,\n                       \"profit_percentage\": doc.variations[i].price_liste,\n                       \"profit_percentage_active\": doc.variations[i].price_list,\n                       \"stock_list\":doc.variations[i].stock_list,\n                       \"picture_min\":doc.variations[i].pictures.min,\n                       \"picture_max\":doc.variations[i].pictures.max\n                        }\n                        // emit array of clientId and clientName as value\n                        // Actually, value can be whatever you want:\n                        //[doc.price_list, doc.pictures.max]\n                    );\n                } */\n\n    /*        \n      var price_list = [\"mayorista\",\"Minorista\",\"Mercado Libre\"];\n       if( doc._id === 'price_list') {\n         //  emit(doc.type, [doc.price_list, 0]);\n              var price_list = doc.price_list;\n        }\n \n     if(doc.status === 'active' || doc.type === 'product'){\n              //emit(price_list, 0);\n           //   for(var i in doc.status) {\n                emit([doc.name,doc.variations[0].sku.value_name],{\n                      \"tipo\": doc.type,\n                      \"name\": doc.name,\n                      \"tags\": doc.tags,\n                      \"available_quantity\": doc.available_quantity,\n                      \"sold_quantity\": doc.sold_quantity,\n                      \"cost_price\": doc.cost_price,\n                      \"limit_discount\": doc.limit_discount,\n                      \"sku\":doc.variations[0].sku.value_name,\n                      \"currency\": doc.currency.value,\n                      //\"price\":doc.variations,\n                      \"variations\":doc.variations\n                      // \"price_list\":doc.price,\n                       // \"category_list\":category_array,\n                       // \"profit_percentage\": doc.variations[idx].price_liste,\n                       // \"profit_percentage_active\": doc.variations[idx].price_list,\n                      //  \"stock_list\":doc.variations[0].stock_list,\n                      //  \"picture_min\":doc.variations[0].pictures.min,\n                      //  \"picture_max\":doc.variations[0].pictures.max\n                });\n         //     }\n              \n      }\n    */  \n}"
      },
      "variations": {
        "map": "function (doc) {\n  emit(doc._id, 1);\n}"
      }
    },
    "language": "javascript"
  }

